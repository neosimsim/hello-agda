\documentclass[12pt]{article}

\usepackage{neosimsim}
\usepackage{neosimsim-a5paper}

\usepackage[backend=biber]{biblatex}
\addbibresource{bibliography.bib}

\usepackage{titlesec}
\newcommand{\sectionbreak}{\clearpage}

\usepackage{fancyvrb}
\newcommand{\ignore}[1]{}

\DefineVerbatimEnvironment%
  {code}{Verbatim}
  {frame=single} % Add fancy options here if you like.

\DefineVerbatimEnvironment%
  {neolisting}{Verbatim}
  {frame=single} % Add fancy options here if you like.

% https://tex.stackexchange.com/questions/18322/using-fancyvrb-verbatim-environment-from-within-newenvironment
\usepackage{fancyvrb,caption,floatrow}
\DeclareNewFloatType{neolistingfloat}{placement=t,fileext=neolisting,name=Listing}
\captionsetup[neolistingfloat]{}

\newenvironment{neocaplisting}[2]
{\VerbatimEnvironment%
 \captionof{neolistingfloat}{#2}\ifx\relax#1\relax\else\label{#1}\fi%
\begin{Verbatim}[frame=single]}
{\end{Verbatim}}

\begin{document}
\section{Installation}
I feel Agda a quite hard to setup. Especially compared to Haskell. This is even
more true if you use Stack and all you have to do, is call \verb+wget+ once.

We also need to preapre our editor for unicode input.

\subsection{Agda}
When I tried to install \verb+agda+ for the first time I just used \verb+cabal+
instead \verb+stack+. I clearly recommend to use \verb+stack+ now.

\begin{lstlisting}
cabal v2-install Agda
stack install Agda
\end{lstlisting}

The package \emph{Agda} installs to binaries

\begin{description}
	\item[agda] The Agda compiler
	\item[agda-mode] An Agda emacs front-end

		I won't go into \verb+agda-mode+ since I'm a vim guy.
\end{description}

You can also check your systems package manager.
\begin{lstlisting}
pacman -S agda
apt-get install agda-mode
\end{lstlisting}

For further information, please have a look at the Agda User
Guide~\cite{agda-user-guide}.

Using Stack you might experience problems with extra-deps. As a personal
recommendation I use the following script to invoke \verb+agda+:
\lstinputlisting[caption=agda]{agda}
This script, by the philosophy of Stack, should always work.
Keep this file some where in \verb+$PATH+ as \verb+agda+.

\subsection{Agda StdLib}
Agda has some built-in modules, but you want at least install
the agda-stdlib~\cite{agda-stdlib} to really have fun with Agda.

Like any good programming language, Agda has no really development
infrastructure, e.‚ÄØg.\ no real package/dependency manager. There are two more
or less convenient ways to install libraries for Agda.

\begin{description}
	\item[Manually] Download the standard library~\cite{agda-stdlib}.
		\begin{lstlisting}[caption={\$HOME/.agda/libraries}]
/home/neosimsim/src/agda/std-lib
		\end{lstlisting}
		\begin{lstlisting}[caption={\$HOME/.agda/defaults}]
standard-library
		\end{lstlisting}
	\item[agda-pkg] An Agda package manager written in python.
		\begin{lstlisting}
pip install agda-pkg
apkg init
apkg install standard-library
		\end{lstlisting}

		Keep in mind that it's a Python tool and might break after some update
		due to dynamic dependencies. It's a scripting language after all.
\end{description}

\subsection{VIM}

Agda makes heavy use of mathematical symbols, e.‚ÄØg. ‚Ñï and ‚Ñ§. So you should be able
to type them in your editor. For vim you can find proper vim-scripts on the
Agda wiki page~\cite{vim-editing}.

Here are snippets of the files.

\begin{neocaplisting}{}{\$HOME/.vim/ftplugin/agda.vim}
source ~/.vim/ftplugin/unicode-keys.vim
imap <buffer> \N ‚Ñï
imap <buffer> \Z ‚Ñ§
imap <buffer> \C ‚ÑÇ
imap <buffer> \Q ‚Ñö
imap <buffer> \R ‚Ñù
imap <buffer> \E ùîº
imap <buffer> \F ùîΩ
imap <buffer> \to ‚Üí
imap <buffer> \mapsto ‚Ü¶
imap <buffer> \infty ‚àû
imap <buffer> \cong ‚âÖ
\end{neocaplisting}

\begin{neocaplisting}{}{\$HOME/.vim/ftplugin/unicode-keys.vim}
imap <leader>to ‚Üí
imap <leader>- ‚Üí
imap <C-_> ‚Üí
imap <leader>To ‚áí
imap <leader>= ‚áí
imap <leader>top ‚ä§
imap <leader>tuple ‚ü®‚ü©<left>
imap <leader>up ‚Üë
imap <leader>updown ‚Üï
imap <leader>ud ‚Üï
\end{neocaplisting}

Safe them under the proper location.

Then you have to tell vim how to detect Agda files.
\begin{lstlisting}[caption={.vim/ftdetect/agda.vim}]
autocmd BufNewFile,BufReadPost *.agda set filetype=agda
autocmd BufNewFile,BufReadPost *.lagda.md set filetype=agda
autocmd BufNewFile,BufReadPost *.lagda.tex set filetype=agda
\end{lstlisting}

A more general way is provided by a command line tool I wrote~\cite{scripts-uni}.

\begin{neolisting}
echo "\N" | uni
‚Ñï
\end{neolisting}

This can be used from withing vim, e.‚ÄØg.\ in visual line mode and typing
\begin{neolisting}
:'<,'>!uni
\end{neolisting}
and also works on any other propper editor, like sam and acme.

If you still use X11 (on Linux) you can also create the file
\lstinputlisting[caption={\$HOME/.Xmodmap}]{Xmodmap}
and call
\begin{neolisting}
xmodmap $HOME/.Xmodmap
\end{neolisting}

Then you can type ‚Ñï by pressing AltGr-n.

If anyone knows a way how todo this in Wayland, please let me know.

\section{Hello World}
\lstinputlisting[caption={hello-world.agda}]{hello-world.agda}

\section{Coming From Haskell}
\subsection{Unicode}
boo
\input{unicode.lagda.tex}
\subsection{Mixfix}

\printbibliography{}
\end{document}
